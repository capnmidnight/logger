{"version":3,"file":null,"sources":["src/wrap.js","src/withFileSystemWarning.js","src/http.js","src/webSocket.js","src/dom.js","src/user.js"],"sourcesContent":["function mangle(name) {\n  return \"_\" + name;\n}\n\nfunction wrapFunction(send, name) {\n  var orig = name;\n  while (console[orig]) {\n    orig = mangle(orig);\n  }\n  console[orig] = console[name];\n  return function () {\n    var args = [];\n    for (var i = 0; i < arguments.length; ++i) {\n      var elem = arguments[i];\n      if(elem === null) {\n        args.push(\"null\");\n      }\n      else if(elem === undefined) {\n        args.push(\"undefined\");\n      }\n      else if (typeof elem === \"object\" && !(elem instanceof String)) {\n        var obj1 = elem,\n          obj2 = {};\n        for (var key in obj1) {\n          obj2[key] = obj1[key];\n          if (obj2[key] !== null && obj2[key] !== undefined) {\n            obj2[key] = obj2[key].toString();\n          }\n        }\n        args.push(obj2);\n      }\n      else {\n        args.push(elem.toString());\n      }\n    }\n    var obj = send({\n      name,\n      args\n    });\n    if (obj) {\n      console[orig].apply(console, arguments);\n    }\n  };\n}\n\nfunction onError(message, source, lineno, colno, error) {\n  colno = colno || window.event && window.event.errorCharacter;\n  var done = false,\n    name = \"error\",\n    stack = error && error.stack;\n\n  if(!stack){\n    if(arguments.callee){\n      var head = arguments.callee.caller;\n      while(head){\n        stack.push(head.name);\n        head = head.caller;\n      }\n    }\n    else{\n      stack = \"N/A\";\n    }\n  }\n\n  var data = {\n      type: \"error\",\n      time: (new Date())\n        .toLocaleTimeString(),\n      message: message,\n      source: source,\n      lineno: lineno,\n      colno: colno,\n      error: error.message,\n      stack: stack\n    };\n\n  while (!done && console[name]) {\n    try {\n      console[name](data);\n      done = true;\n    }\n    catch (exp) {\n      name = mangle(name);\n    }\n  }\n}\n\nexport default function wrap(send, redirects = [\"log\", \"info\", \"error\"]) {\n  if (send !== null) {\n    redirects.forEach((name) =>\n      console[name] = wrapFunction(send, name));\n  }\n\n  window.addEventListener(\"error\", function(evt){\n    onError(evt.message, evt.filename, evt.lineno, evt.colno, evt.error);\n  }, false);\n};","function identity(data) {\n  return data;\n}\n\nexport default function withFileSystemWarning(thunk) {\n  const isBad = location.protocol === \"file:\";\n\n  if(isBad) {\n    console.warn(\"Can't perform HTTP requests from the file system. Not going to setup the error proxy, but will setup the error catch-all.\");\n  }\n\n  return isBad ? identity : thunk;\n};","import wrap from \"./wrap\";\nimport withFileSystemWarning from \"./withFileSystemWarning\";\n\nexport default function http(target, redirects) {\n  return wrap(fileSystemWarning(function (data) {\n    var req = new XMLHttpRequest();\n    req.open(\"POST\", target);\n    req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n    req.send(JSON.stringify(data));\n    return data;\n  }), redirects);\n}\n","import wrap from \"./wrap\";\nimport withFileSystemWarning from \"./withFileSystemWarning\";\n\nexport default function webSocket(target, redirects) {\n  const socket = new WebSocket(target);\n  return wrap(fileSystemWarning(function (data) {\n    socket.send(JSON.stringify(data));\n    return data;\n  }), redirects);\n}\n","import wrap from \"./wrap\";\n\nexport default function dom(target, redirects) {\n  const output = document.querySelector(target);\n  return wrap(function (data) {\n    const elem = document.createElement(\"pre\");\n    elem.appendChild(document.createTextNode(JSON.stringify(data)));\n    output.appendChild(elem);\n    return data;\n  }, redirects);\n}\n","import wrap from \"./wrap\";\n\nexport default function user(target, redirects) {\n  if (!(target instanceof Function)) {\n    console.warn(\"The target parameter was expected to be a function, but it was\", target);\n  }\n  else {\n    return wrap(target, redirects);\n  }\n}"],"names":["mangle","name","wrapFunction","send","orig","console","args","i","arguments","length","elem","push","undefined","String","obj1","obj2","key","toString","obj","apply","onError","message","source","lineno","colno","error","window","event","errorCharacter","done","stack","callee","head","caller","data","Date","toLocaleTimeString","exp","wrap","redirects","forEach","addEventListener","evt","filename","identity","http","target","fileSystemWarning","req","XMLHttpRequest","open","setRequestHeader","JSON","stringify","webSocket","socket","WebSocket","dom","output","document","querySelector","createElement","appendChild","createTextNode","user","Function","warn"],"mappings":"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"}