{"version":3,"file":null,"sources":["src/wrap.js","src/user.js","src/withFileSystemWarning.js","test/index.js"],"sourcesContent":["function mangle(name) {\n  return \"_\" + name;\n}\n\nfunction wrapFunction(send, name) {\n  var orig = name;\n  while (console[orig]) {\n    orig = mangle(orig);\n  }\n  console[orig] = console[name];\n  return function () {\n    var args = [];\n    for (var i = 0; i < arguments.length; ++i) {\n      var elem = arguments[i];\n      if (typeof elem === \"object\" && !(elem instanceof String)) {\n        var obj1 = elem,\n          obj2 = {};\n        for (var key in obj1) {\n          obj2[key] = obj1[key];\n          if (obj2[key] !== null && obj2[key] !== undefined) {\n            obj2[key] = obj2[key].toString();\n          }\n        }\n        args.push(obj2);\n      }\n      else if(elem) {\n        args.push(elem.toString());\n      }\n      else{\n        args.push(\"null\");\n      }\n    }\n    var obj = send({\n      name,\n      args\n    });\n    if (obj) {\n      console[orig].apply(console, arguments);\n    }\n  };\n}\n\nfunction onError(message, source, lineno, colno, error) {\n  colno = colno || window.event && window.event.errorCharacter;\n  var done = false,\n    name = \"error\",\n    stack = error && error.stack;\n\n  if(!stack){\n    if(arguments.callee){\n      var head = arguments.callee.caller;\n      while(head){\n        stack.push(head.name);\n        head = head.caller;\n      }\n    }\n    else{\n      stack = \"N/A\";\n    }\n  }\n\n  var data = {\n      type: \"error\",\n      time: (new Date())\n        .toLocaleTimeString(),\n      message: message,\n      source: source,\n      lineno: lineno,\n      colno: colno,\n      error: error.message,\n      stack: stack\n    };\n\n  while (!done && console[name]) {\n    try {\n      console[name](data);\n      done = true;\n    }\n    catch (exp) {\n      name = mangle(name);\n    }\n  }\n}\n\nexport default function wrap(send, redirects = [\"log\", \"info\", \"error\"]) {\n  if (send !== null) {\n    redirects.forEach((name) =>\n      console[name] = wrapFunction(send, name));\n  }\n\n  window.addEventListener(\"error\", function(evt){\n    onError(evt.message, evt.filename, evt.lineno, evt.colno, evt.error);\n  }, false);\n};","import wrap from \"./wrap\";\n\nexport default function user(target, redirects) {\n  if (!(target instanceof Function)) {\n    console.warn(\"The target parameter was expected to be a function, but it was\", target);\n  }\n  else {\n    return wrap(target, redirects);\n  }\n}","function identity(data) {\n  return data;\n}\n\nexport default function withFileSystemWarning(thunk) {\n  const isBad = location.protocol === \"file:\";\n\n  if(isBad) {\n    console.warn(\"Can't perform HTTP requests from the file system. Not going to setup the error proxy, but will setup the error catch-all.\");\n  }\n\n  return isBad ? identity : thunk;\n};","import setup from \"../src/user\";\nimport unused from \"../src/http\";\n\nvar tbody = document.querySelector(\"tbody\");\nsetup(function(obj){\n  var row = document.createElement(\"tr\"),\n    cell1 = document.createElement(\"td\"),\n    cell2 = document.createElement(\"td\"),\n    cell3 = document.createElement(\"td\");\n  cell1.appendChild(document.createTextNode(performance.now().toFixed(3)));\n  cell2.appendChild(document.createTextNode(obj.name));\n  cell3.appendChild(document.createTextNode(obj.args.map(function(o){\n    return JSON.stringify(o);\n  }).join(\", \")));\n  row.appendChild(cell1);\n  row.appendChild(cell2);\n  row.appendChild(cell3);\n  tbody.appendChild(row);\n});\n\nconsole.log(\"OK\");\n\nvar parts = [\"log\", \"error\", \"warn\", \"info\"];\nfor(var i = 0; i < 100; ++i){\n  console[parts[i % parts.length]](\"Message #\", i);\n}\n\nthrow new Error(\"Whooops!\");"],"names":["mangle","name","wrapFunction","send","orig","console","args","i","arguments","length","elem","String","obj1","obj2","key","undefined","toString","push","obj","apply","onError","message","source","lineno","colno","error","window","event","errorCharacter","done","stack","callee","head","caller","data","Date","toLocaleTimeString","exp","wrap","redirects","forEach","addEventListener","evt","filename","user","target","Function","warn","identity","tbody","document","querySelector","setup","row","createElement","cell1","cell2","cell3","appendChild","createTextNode","performance","now","toFixed","map","o","JSON","stringify","join","log","parts","Error"],"mappings":"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"}